---
title: "Final"
author: "Eva Portillo Molina"
format: html
---
```{r}

library(readr)
library(tidyverse)
library(here)
summer_movies <- read_csv(here::here("data","summer_movies.csv"))

```
```{r}
library(gtsummary)
tbl_summary(
	summer_movies,
	by= title_type,
	include = c(title_type, genres, runtime_minutes, average_rating, num_votes),
	label = list(
		genres ~ "Genres",
		average_rating ~ "Average Rating",
		num_votes ~ "Number of Votes",
		runtime_minutes ~ "Run Time Minutes"
	),
	missing_text = "Missing") |>
	add_overall(col_label = "**Total**") |>
	bold_labels() |>
	modify_header(label = "**Variable**")


```

Regression and making figure

```{r}
install.packages("tidyverse")
library(tidyverse)
library(broom)

tbl_uvregression(
	summer_movies,
	y = num_votes,
	include = c(genres,runtime_minutes, 
							average_rating),
	#did install.packages("broom.helpers")
	method = "lm")
#can also use this:


#creating histogram
hist(summer_movies$average_rating)


#attempting to use broom example
lm <- lm(num_votes ~ runtime_minutes + genres +
							average_rating, data = summer_movies)
tidy_lm<- tidy(lm, conf.int = TRUE)



```


Creating a function
```{r}

newsd <- function(x){
	n <- length(x)
	mean_val <- sum(x) / n
	stddev <- sqrt(sum((x-mean_val)^2)/(n-1))
	return(stddev)
}

clean_runtime <- summer_movies$runtime_minutes[!is.na(summer_movies$runtime_minutes)]
clean_runtime


sd <- newsd(clean_runtime)
print(sd) 



```


## Quarto

Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see <https://quarto.org>.

## Running Code

When you click the **Render** button a document will be generated that includes both content and the output of embedded code. You can embed code like this:

```{r}
1 + 1
```

You can add options to executable code like this 

```{r}
#| echo: false
2 * 2
```

The `echo: false` option disables the printing of code (only output is displayed).
